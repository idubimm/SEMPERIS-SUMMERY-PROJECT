pipeline { 
  agent none 
  stages {
    stage('deploy namespace ') {
      agent {
         kubernetes {
           yamlFile './kubernetes/yaml-files/00-namespace-flask-python.yaml'  
        } 
      }
    } 
    stage('deploy postgres and its service ')  {
       agent {
        kubernetes {
           yamlFile 'kubectl apply -f ./kubernetes/yaml-files/01-postgres.yaml'  
        } 
      } 
    }
    stage('deploy flask app ')   {
       agent {
        kubernetes {
           yamlFile 'kubectl apply -f ./kubernetes/yaml-files/02-flask.yaml' 
        } 
      }
    } 
    stage('deploy LB srvice ')   {
       agent {
        kubernetes {
           yamlFile 'kubectl apply -f ./kubernetes/yaml-files/03-services.yaml'  
        } 
      } 
    }   
  }
}
